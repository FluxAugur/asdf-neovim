#!/usr/bin/env bash

auth=""
if [ -n "$GITHUB_API_TOKEN" ]; then
 auth="-H 'Authorization: token $GITHUB_API_TOKEN'"
fi

# Fetch all tag names, and get only second column. Then remove all unnecessary characters.
list_of_versions=$(
  curl -sL $auth https://api.github.com/repos/neovim/neovim/tags \
    | grep name \
    | sed -E -e 's/^\s+".+":\s"v?(untagged-0e014f77944d8517d79f|stable|nightly|[0-9]\.[0-9]\.[0-9])",?/\1/' \
    | sort \
    | tail -n +14
)

echo $list_of_versions
